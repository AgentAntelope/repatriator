<html>
<head>
    <title>Building a Server - Repatriator Documentation</title>
</head>
<body>
    <h1>Building a Server</h1>
    <p>
    by <a href="mailto:superjoe30@gmail.com">Andrew Kelley</a> last updated on Jan 31 2011
    </p>
    <h2>Ingredients</h2>
    <h3>Computer (Minimum Requirements)</h3>
    <ul>
        <li>5 serial ports</li>
        <li>2 USB ports</li>
        <li>1 ethernet port</li>
        <li>Processor: Single-core 1.0Ghz (multi-core OK).</li>
        <li>1 GB DDR2 RAM</li>
        <li>100 GB Hard Drive</li>
        <li>Must be able to run Windows 7</li>
    </ul>
    <h4>Performance Tips</h4>
    <p>
        The server computer has low requirements. Since only one client can
        connect at a time, and the nature of the work is not computationally
        intensive, the server does not need high-end components.
    </p>
    <p>Do not even purchase a graphics card. It won't help at all.</p>
    <h3>Camera and Lens</h3>
    <ul>
        <li>1 Canon 7D Camera</li>
        <li>1 Canon 1.4x TeleExtender</li>
        <li>1 12mm EF Extension Tube</li>
        <li>1 Canon 100mm X2.8LQSM</li>
    </ul>
    <h3>Peripheral</h3>
    <ul>
        <li>1 <a href="http://www.pwrusb.com/">PowerUsb</a></li>
        <li>3 power strips</li>
        <li>5 silverpak motors from Linn (TODO: be more specific)</li>
    </ul>
    <h2>Hooking up the hardware</h2>
    <p>After you put together your server computer, and you have the Repatriator
    hardware in front of you, it's time to hook everything up.
    </p>
    <h3>Setting up the Camera</h3>
    <p>Repatriator requires a Canon 7D Camera</p>
    <ol>
        <li>Attach the lenses mentioned above in the order they are listed.</li>
        <li>Update the physical switches on the lens to look like this:
        <pre>Camera Lens Switches:
    [X] FULL
    [ ] 0.5m - Infinite
    [ ] 0.3m - 0.5m

    [X] AF
    [ ] MF

    Stabilizer:
    [ ] On
    [X] Off</pre></li>
        <li>If there is a battery, remove it. You must use an AC adapter instead.</li>
        <li>We need to configure some settings on the camera. Plug it into a power source and turn it on.</li>
        <li>
            Use the camera's menu to Reset All Settings.
            Then change these settings:
            <ul>
                <li>Auto Power Off: Off</li>
            </ul>
        </li>
        <li>Leave the camera's power switch in the "On" position.
            The server will manage the camera's power by cycling power.
    </ol>
    <h3>How to set up the power strips</h3>
    <p>
        You need 3 power strips, plus 1 
        <a href="http://www.pwrusb.com/">PowerUSB</a>.
        This table shows you which components get plugged into which power
        strip.
    </p>
    <table border="1">
        <tr>
            <th>Component</th>
            <th>Where to plug it in</th>
            <th>Reason</th>
        </tr>
        <tr>
            <td>Power Strip A</td>
            <td>The Wall</td>
            <td>We use this power strip for components that always stay on.</td>
        </tr>
        <tr>
            <td>PowerUSB</td>
            <td>Power Strip A</td>
            <td>This power strip controls power for components that the server
                can toggle on/off.</td>
        <tr>
            <td>Power Strip B</td>
            <td>PowerUSB Port 1</td>
            <td>This power strip will be toggled via PowerUSB.</td>
        </tr>
        <tr>
            <td>Power Strip C</td>
            <td>PowerUSB Port 2</td>
            <td>This power strip will also be toggled via PowerUSB. We use 2
                strips like this in order to distribute the Amp load to not
                blow a fuse in the PowerUSB.</td>
        </tr>
        <tr>
            <td>Computer</td>
            <td>Power Strip A</td>
            <td>The computer must always stay on. If you're using a monitor,
                plug that into Power Strip A too.</td>
        </tr>
        <tr>
            <td>Motor A (pin spinner)</td>
            <td>Power Strip B</td>
            <td>This component's power is toggled by the computer.</td>
        </tr>
        <tr>
            <td>Motor B (rotating rod)</td>
            <td>Power Strip B</td>
            <td>This component's power is toggled by the computer.</td>
        </tr>
        <tr>
            <td>Motor X (stage)</td>
            <td>Power Strip B</td>
            <td>This component's power is toggled by the computer.</td>
        </tr>
        <tr>
            <td>Motor Y (stage)</td>
            <td>Power Strip C</td>
            <td>This component's power is toggled by the computer.</td>
        </tr>
        <tr>
            <td>Motor Z (lift)</td>
            <td>Power Strip C</td>
            <td>This component's power is toggled by the computer.</td>
        </tr>
        <tr>
            <td>Canon 7D Camera</td>
            <td>Power Strip C</td>
            <td>This component's power is toggled by the computer.</td>
        </tr>
        <tr>
            <td>Lights</td>
            <td>Power Strip C</td>
            <td>This component's power is toggled by the computer.</td>
        </tr>
    </table>
    <h3>How to set up the motors so that they are recognized properly</h3>
    <p>
        It does not matter which serial ports you plug the motors into.
        Ensure that they are all connected securely.
    </p>
    <p>
        It does matter, however, which Driver Address you set the motors to.
        This is a physical switch on each motor that you need to configure.
        This table shows you which Driver Address to assign to each motor.
    </p>
    <table border="1">
        <tr>
            <th>Motor</th>
            <th>Driver Address</th>
        </tr>
        <tr>
            <td>Motor A (pin spinner)</td>
            <td>9</td>
        </tr>
        <tr>
            <td>Motor B (rotating rod)</td>
            <td>7</td>
        </tr>
        <tr>
            <td>Motor X (stage)</td>
            <td>3</td>
        </tr>
        <tr>
            <td>Motor Y (stage)</td>
            <td>5</td>
        </tr>
        <tr>
            <td>Motor Z (lift)</td>
            <td>1</td>
        </tr>
    </table>

</body>
</html>

