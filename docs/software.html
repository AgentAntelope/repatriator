<html>
<head>
    <title>Installing and Configuring the Server - Repatriator Documentation</title>
</head>
<body>
    <h1>Installing and Configuring the Server</h1>
    <p>
    by <a href="mailto:superjoe30@gmail.com">Andrew Kelley</a> on Jan 22 2011
    </p>
    <ol>
        <li>Build the computer according to the <a href="hardware.html">hardware docs</a>.</li>
        <li>Install Windows 7 64-bit Professional Edition.
            <ul>
            <li>There should be 1 user named "repatriator" with a secure
            password, admin privileges, and that automatically gets logged in.</li>
            <li><a href="http://www.microsoft.com/windowsxp/using/mobility/getstarted/remoteintro.mspx">Enable Remote Desktop administration</a></li>
            </ul>

        </li>
        <li>Install <a href="http://msysgit.googlecode.com/files/Git-1.7.3.1-preview20101002.exe">Git for Windows</a></li>
        <li>
            Install the Repatriator Server
            <ol>
                <li>Get the code from GitHub
                    <ol>
                        <li>Run Git Bash</li>
                        <li><pre>pwd</pre>This should return /c/Users/repatriator.
                        <li>
                            <pre>git clone https://github.com/thejoshwolfe/repatriator.git</pre>
                        </li>
                    </ol>
                </li>
                <li>Install <a href="http://www.python.org/ftp/python/3.1.3/python-3.1.3.msi">Python 3.1 32-bit</a> to C:\Python31</li>
                <li>Install <a href="http://downloads.sourceforge.net/project/pywin32/pywin32/Build%20214/pywin32-214.win32-py3.1.exe?r=http%3A%2F%2Fsourceforge.net%2Fprojects%2Fpywin32%2Ffiles%2Fpywin32%2FBuild%2520214%2F&ts=1295752057&use_mirror=superb-sea2">pywin32-214.win32-py3.1.exe</a></li>
                <li>Copy C:\Python31\Lib\site-packages\pywin32_system32\pywintypes31.dll to C:\Windows\System32\</li>
                <li> Install <a href="https://github.com/downloads/superjoe30/pyedsdk/edsdk-0.6.win32-py3.1.exe">pyedsdk</a></li>
                <li>Extract "<a href="http://superjoesoftware.com/temp/EDSDK%202.7%20Windows.zip">EDSDK 2.7 Windows.zip</a>"\EDSDK\Dll\*.dll to C:\Windows\System32\</li>
                <li> Install <a href="http://www.superjoesoftware.com/temp/silverpak-0.3.win32.exe">pysilverpak</a>
                </li>
                <li>Install <a href="http://downloads.sourceforge.net/project/imagemagick/6.6.7-sources/ImageMagick-6.6.7-1-windows.zip?r=http%3A%2F%2Fsourceforge.net%2Fprojects%2Fimagemagick%2F&ts=1295752746&use_mirror=superb-sea2">ImageMagick</a> </li>
                <li>Make sure convert.exe from ImageMagick is in your <a href="http://www.itechtalk.com/thread3595.html">PATH variable</a></li>
                <li>Install <a href="https://github.com/downloads/superjoe30/pypowerusb/powerusb-0.2.win32-py3.1.exe">pypowerusb</a></li>
                <li>Copy PwrUSBDll.dll to C:\Windows\System32\</li>
                <li>Create these registry entries:
                <table border="1">
                    <tr>
                        <th>Key</th>
                        <th>Property Name</th>
                        <th>Value</th>
                        <th>Comments<th>
                    </tr>
                    <tr>
                        <td>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</td>
                        <td>repatriator</td>
                        <td>C:\Users\repatriator\repatriator\server\run_server.bat</td>
                        <td>This makes the server start when the computer boots</td>
                    </tr>
                </table>
                </li>
            </ol>
        </li>
        <li>Configure the server
            <ol>
                <li>Create a file called config.py in C:\Users\repatriator\repatriator\server\</li>
                <li>
                <p>Look at the file named settings.py in the same folder.
                These are all of the options that you may configure, along
                with their defaults. Do not edit this file. Instead, overwrite
                these defaults in config.py using python syntax.
                </p><p>
                Here is an example config.py:
                </p>
                <pre>HOST = 'repatriator.asu.edu'
PORT = 57051
LOG_LEVEL = 'WARNING'</pre>
                </li>
            </ol>
        </li>
        <li>Log out, log back in. The server should start automatically.</li>
        <li>Configure user accounts
            <ol>
                <li>Using a different computer (you probably want to use a laptop so that you can watch the motors move), start the RepatriatorClient.</li>
                <li>Add your server with the New button. The default user name and password is:
                <pre>username: default_admin
password: temp1234</pre></li>
                <li><p>Connect using the Admin button. Create for yourself an
                admin user account and regular user account. This is similar
                to the reason we don't log in as root on our linux machines.
                </p><p>This dialog is how you will do administration for your users. But for now let's get back to making the system work.</p>
                </li>
                <li>Delete the default_admin account. Let's not leave that security risk laying around!</li>
            </ol>
        </li>
        <li>Configure the motor boundaries and locations
            <ol>
                <li>Using the RepatriatorClient program, use your admin
                account and connect with the Login button.
                This is a different interface than you see when you log
                in with a non-admin account.
                </li>
                <li>Configure the boundaries
                    <ol>
                        <li>Carefully adjust the lift location until it is 
                        as high as you ever want it to go. Press the button
                        to save this boundary. Carefully adjust it until it
                        is as low as you ever want it to go. Press the button
                        to save this boundary.
                        </li>
                        <li>Repeat for the X-Y stage motors, and both orbit
                        motors.</li>
                    </ol>
                </li>
                <li>Configure the locations. These are bookmark buttons that
                you can click to go to set locations. 
                    <ol>
                        <li>There must be at least one Location, and the first
                        one must be called "Home". This is where the machine
                        moves to just after starting up and initializing.</li>
                        <li>Create any more locations that you want, for example
                        if you have a ruler or label location.</li>
                    </ol>
                </li>
            </ol>
        </li>
        <li>Everything should be operational. If you run into any trouble,
        the file C:\Users\repatriator\repatriator\server\data\server.log will
        have more information.
        </li>
    </ol>
    </body>
</html>

